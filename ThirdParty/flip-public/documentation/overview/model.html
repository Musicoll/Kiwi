<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Flip Overview: Interfacing with the Model</title>
<style>
* {font-family: 'Lucida Grande', Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
body {background-color: #fff; }
p {color: black; font-size: 13px; margin-bottom: 10px;}
h1 {color: black; font-size: 28px; margin-bottom: 32px; padding-top: 24px; font-weight: normal; display: block; }
h2 {color: #3c4c6c; display: block; font-size: 24px; font-weight: normal; margin-bottom: 20px; margin-top: 42px; border-bottom-color: #8391a8; border-bottom-style: solid; border-bottom-width: 1px;}
h3 {color: black; font-size: 19px; margin-bottom: 4px; margin-top: 28px; font-weight: normal; display: block; }
a {color: #36c; text-decoration: none; cursor:pointer; }
a:active {color: #36c; text-decoration: none; cursor:pointer; }
a:hover {color: #36c; text-decoration: underline; cursor:pointer; }
.aerr {color: #f00}
h2 a {color: #3c4c6c; text-decoration: none; cursor:auto; }
h2 a:active {color: #3c4c6c; text-decoration: none; cursor:auto; }
h2 a:hover {color: #3c4c6c; text-decoration: none; cursor:auto; }
h3 a {color: black; text-decoration: none; cursor:auto; }
h3 a:active {color: black; text-decoration: none; cursor:auto; }
h3 a:hover {color: black; text-decoration: none; cursor:auto; }
footer {font-size: 10px; position: fixed; display: block; bottom: 0px; background-color: #f1f5f9; border-top-color: #c7cfd5; border-top-style: solid; border-top-width: 1px; width: 100%; height:22px; padding-top: 7px; padding-left: 7px;}
div {display: block;}
.codeblock {margin-top:17px; margin-bottom:17px; clear: both; display: block; color: #333; }
pre {font-family: Courier, Consolas, monospace; font-size: 12px; height: 14px; line-height: 14px; margin-bottom: 0px; margin-left: 6px; margin-right: 4px; margin-top: -1px;}
small pre {color:#888;}
emph pre {color:#000;}
table {padding-top:5px; padding-bottom:6px; margin-bottom:12px; background-color: #f1f5f9; border-color: #c7cfd5; border-style: solid; border-width: 1px; width: 100%;}
tr {}
td > p {margin-left: 6px; height: 12px;}
.note {margin-top:21px; margin-bottom:22px; padding-left: 8px; padding-right: 8px; background-color: #fff; border-color: #5088c5; border-style: solid; border-width: 1px; display: block;}
.note strong {margin-right: 8px;}
.note p {margin-top: 7px;}
.important {margin-top:21px; margin-bottom:22px; padding-left: 8px; padding-right: 8px; background-color: #f1f5f9; border-color: #5088c5; border-style: solid; border-width: 1px; display: block;}
.important strong {margin-right: 8px;}
.important p {margin-top: 7px;}
.warning {margin-top:21px; margin-bottom:22px; padding-left: 8px; padding-right: 8px; background-color: #f8e3e1; border-color: #c5443e; border-style: solid; border-width: 1px; display: block;}
.warning strong {margin-right: 8px;}
.warning p {margin-top: 7px;}
.caption p {color: black; font-size: 10px; margin-bottom: 10px;}
img {margin-top:10px; margin-bottom:10px;}
ul {margin-left: 17px; margin-bottom: 10px;}
ol {margin-left: 17px; margin-bottom: 10px;}
li {color: black; font-size: 13px; margin-bottom: 7px;}
code {font-family: Courier, Consolas, monospace;}
#content {padding-left: 26px; padding-right: 26px; position: absolute; top: 30px; left: 230px; width: 750px;}
#toc {width: 230px; position: fixed; top: 30px; background-color: #f1f5f9; height: 100%; border-right-color: #c7cfd5; border-right-style: solid; border-right-width: 1px; padding-left: 0px; padding-top: 17px; overflow: auto;}
#toc > ul {list-style-type: none;}
#toc > ul > li {font-size: 11px; }
#toc > ul > li > ul {list-style-type: none; margin-top:8px;}
#toc > ul > li > ul > li {font-size: 11px; }
#toc > p {font-size: 13px; margin-left: 17px;}
.codeblock > p {margin-bottom: 3px; font-size: 11px;}
.codeblock > p > strong {margin-right: 10px; color: #222;}
.nav {font-size: 10px; margin-top: 20px; }
.nav > span {margin-right: 20px;}
.bottomspacer {height:100px;}
#header {width:100%; position: fixed; background-color: #111; height: 30px; z-index: 900;}
#header > p {color:#fff; font-size: 13px; padding-top: 6px; padding-left: 17px; }
#header > p > a {color:#fff; font-size: 13px; text-decoration: none; cursor:pointer; padding-right: 56px;}
.sectioncode {background-color: #f6f6f6; padding: 12px; margin-top: 18px;}
.sectioncode > h3 {margin-top: 0px; padding-bottom: 8px;}
hr { display: block; height: 1px; border: 0; border-top: 1px solid #eee; margin: 28px 0; padding: 0; }</style>
</head>

<body>

<div id="header">
<div style="width: 1006px;"></div>
<p><a href="../index.html">Flip Documentation Library</a><a href="../overview/index.html">Flip Overview</a></p>
</div>
<div id="toc">
<p>Flip Overview</p>
<ul>
<li><a href="../overview/about.html">About Flip</a></li>
<li><a href="../overview/how.html">How it Works</a></li>
<li><a href="../overview/model.html">Interfacing with the Model</a>	<ul>
	<li><a href="../overview/model.html#control">Controlling the Model</a></li>
	<li><a href="../overview/model.html#view">Observing the Model</a></li>
	</ul>
</li>
<li><a href="../overview/undo.html">Undo/Redo System</a></li>
<li><a href="../overview/thread.html">Threading System</a></li>
<li><a href="../overview/document.html">Document Format, Conversion</a></li>
</ul>
</div>

<div id="content">
<div class="nav" align="right">
<a href="how.html">previous</a><span>&nbsp;</span><a href="undo.html">next</a></div>

<h1>Interfacing with the Model</h1>

<p>When interfacing with the model, the code can be separated in two parts:</p>

<ol>
<li>the part that control the model</li>
<li>the part that reacts to model changes</li>
</ol>

<h2><a name="control">Controlling the Model</a></h2>

<p>Controlling the model is done by directly changing the model, just as you would do with regular classes.</p>

<p>If a class <code>Element</code> has two members <code>position</code> and <code>length</code>, changing the position and the length of the element is as simple as:</p>

<div class="codeblock"><table>
<tr><td><pre>element.position = some_position;</pre></td></tr>
<tr><td><pre>element.length = some_length;</pre></td></tr>
</table></div>

<p>The members used by classes are actually Flip objects. They are proxies which handle changes to the model.</p>

<p>For example, to write a class with a member:</p>

<div class="codeblock"><table>
<tr><td><pre>int	position;</pre></td></tr>
</table></div>

<p>You would transform it to:</p>

<div class="codeblock"><table>
<tr><td><pre>flip::Int64	position;</pre></td></tr>
</table></div>

<p>And to write a class with a list of members:</p>

<div class="codeblock"><table>
<tr><td><pre>std::list&lt;Element&gt;	element_arr;</pre></td></tr>
</table></div>

<p>You would transform it to:</p>

<div class="codeblock"><table>
<tr><td><pre>flip::Array&lt;Element&gt; element_arr;</pre></td></tr>
</table></div>

<p>Manipulating Flip containers is very close to the conventions used by the C++ standard library (STL). Adding an element is done with <code>insert</code>, and erasing an element is done with <code>erase</code>. Other functions are provided in a monolithic way like in the original STL in order to ensure that developers will feel right at home.</p>

<h2><a name="view">Observing the Model</a></h2>

<p>When a client modifies its own model or receives a modification (transaction) of the model from another client from the server, the model is directly modified.</p>

<p>The client of the model will have registered one or more observers to be notified when the model changes. These observer are called with the model's root object passed as a argument.</p>

<p>When the client observer is called, Flip maintains the previous version of the model as well as the current one as applied by the transaction. This allows the client to know:</p>

<ul>
<li>exactly which objects were modified</li>
<li>the value of an object before the modification</li>
<li>what was inserted/erased from a container</li>
<li>what was moved from one container to another</li>
</ul>

<p><center><img src="model.png" /></center></p>

<p>The client is then responsible for parsing the model tree to ensure that its local representation of the model matches the one from Flip.</p>

<p>Furthermore, Flip was designed to make this task as simple as possible. The model tree can be parsed in any direction, parsed multiple times, and so on. Multiple represented objects can also be attached to Flip objects. We have also supplied some code patterns that can simplify your work.</p>

<p>As long as the model client does not exit during the observer callback, Flip still maintains the old and current versions of the model. Each Flip object, as well as your custom classes, have an <code>added()</code> method which can be called to see if an object or its compound objects have been modified. This call is also recursive.</p>

<p>Whether your local model uses object pointers, references, or IDs, you can attach it to any Flip object. This architecture offers simple but powerful interoperability with Flip and your GUI or external libraries.</p>

<div class="nav" align="right">
<a href="how.html">previous</a><span>&nbsp;</span><a href="undo.html">next</a></div>

<div class="bottomspacer">&nbsp;</div>
</div>
</body>
</html>
